<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>时间轴可视化图</title>
    <script src="echarts.js"></script>
    <script src="jquery-3.5.1.min.js"></script>
</head> 
<body>
 
<div id="main" style="width: 1600px;height: 1000px"></div>
 
<script type="text/javascript">
 
    // 第一部分
    // 定义一个rankData的变量存放数据，他是一个列表，其中有多个字典，每个字典代表了某天的数据情况
    // 内容包括日期（date），分类（category），具体数据（data-包含每个商品的累计销量情况）
    var rankData = [
        {
            "date": "2011",
            "category": "2011",
            "data": [
                {'name': '中国', 'value': 954},
                {'name': '日本', 'value': 925},
                {'name': '美国', 'value': 895},
                {'name': '英国', 'value': 794},
                {'name': '俄罗斯', 'value': 660},
                {'name': '印度', 'value': 560},
                {'name': '法国', 'value': 527},
                
            ]
        },
        {
            "date": "2012",
            "category": "2012",
            "data": [
            {'name': '中国', 'value': 912},
                {'name': '日本', 'value': 914},
                {'name': '美国', 'value': 852},
                {'name': '英国', 'value': 742},
                {'name': '俄罗斯', 'value': 650},
                {'name': '印度', 'value': 557},
                {'name': '法国', 'value': 487},
                
            ]
        },
        {
            "date": "2013",
            "category": "2013",
            "data": [
            {'name': '中国', 'value': 901},
                {'name': '日本', 'value': 878},
                {'name': '美国', 'value': 835},
                {'name': '英国', 'value': 724},
                {'name': '俄罗斯', 'value': 630},
                {'name': '印度', 'value': 543},
                {'name': '法国', 'value': 467},
                
            ]
        },
        {
            "date": "2014",
            "category": "2014",
            "data": [
            {'name': '中国', 'value': 879},
                {'name': '日本', 'value': 835},
                {'name': '美国', 'value':825},
                {'name': '英国', 'value': 704},
                {'name': '俄罗斯', 'value': 610},
                {'name': '印度', 'value': 531},
                {'name': '法国', 'value': 450},
                
            ]
        },
        {
            "date": "2015",
            "category": "2015",
            "data": [
            {'name': '中国', 'value': 860},
                {'name': '日本', 'value': 820},
                {'name': '美国', 'value': 805},
                {'name': '英国', 'value': 700},
                {'name': '俄罗斯', 'value': 598},
                {'name': '印度', 'value': 522},
                {'name': '法国', 'value': 437},
               
            ]
        },
        {
            "date": "2016",
            "category": "2016",
            "data": [
            {'name': '中国', 'value': 840},
                {'name': '日本', 'value': 805},
                {'name': '美国', 'value': 782},
                {'name': '英国', 'value': 674},
                {'name': '俄罗斯', 'value': 574},
                {'name': '印度', 'value': 506},
                {'name': '法国', 'value': 412},
                
            ]
        },
        {
            "date": "2017",
            "category": "2017",
            "data": [
            {'name': '中国', 'value': 798},
                {'name': '日本', 'value': 775},
                {'name': '美国', 'value': 745},
                {'name': '英国', 'value': 644},
                {'name': '俄罗斯', 'value': 550},
                {'name': '印度', 'value': 483},
                {'name': '法国', 'value': 427},
                
            ]
        },
    ]
 
 
    // 第二部分
    // 定义标题（title），以及播放时可视化动态变化的时间间隔（playInteval）。
    // 由于每天销量数据已经按照降序排列，之后的两层for循环的目的是在每天排行榜上对应的位置使用对应的颜色
 
   
   
     
        // 第二部分
        // 定义标题（title），以及播放时可视化动态变化的时间间隔（playInteval）。
        // 由于每天销量数据已经按照降序排列，之后的两层for循环的目的是在每天排行榜上对应的位置使用对应的颜色
     
       
        var title='世界国家GDP',
        
             playInterval = 1000;     //  定义时间间隔
        // 排行颜色
        var colorListS1 = [];
        var colors = [];
     
        // 双重for循环，第一层遍历每段列表
        for (var i = 0; i < rankData.length; i++) {
            var colorListF1 = [];
            // 第二层遍历每段列表中的字典
            for (var j = 0; j > rankData[i].data.length; j++) {
                // 每阶段内部循环，
                          // 排行榜上项目的名称
                                 // 排行榜上项目名称和对应的颜色
                                                                // 其中每个排名位置的颜色不变
            }
                            // 每次排行榜的数据字典放入总体的列表中
        }
     
     
        // 第三部分
        // 设置option的内容，这部分是设置option中固定的部分，也就是不需要随时间和数据内容变化的部分，
        // 主要包括动画效果设置，时间轴设置（timeline），标题设置（title），网格设置（grid），x轴设置（xAxis），y轴设置（yAxis），数据设置（series）。
     
        // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('main'));
     
        // 基础设置
        var option = {
            title: {
                text: 'GDP',
                subtext: 'Z19045421 李鑫',
                left: 'center'
            },
            baseOption: {
                animationDurationUpdate: playInterval * 2,          // 数据更新动画的时长
                animationEasingUpdate: "quinticInOut",              // 数据更新动画的缓动效果
                timeline: {                          // 时间轴相关参数
                    show: false,                    // 隐藏时间轴
                    axisType: "category",            // 轴的类型：类别型
                    orient: "vertical",              // 摆放方式：竖直放置
                    autoPlay: true,                  // 自动播放
                    loop: false,                     // 循环播放
                    playInterval: playInterval,      // 表示播放的速度（跳动的事件按间隔），单位毫秒（ms）
 
                    left: null,                  // timeline组件离容器左侧的距离
                    right: 30,                  // timeline组件离容器右侧的距离
                    top: 330,                 // timeline组件离容器上侧的距离
                    bottom: 100,                 // timeline组件离容器下侧的距离
                    height: null,
                    label: {                    // 标签样式
                        normal: {
                            show: true,          // 显示轴线
                            color: "blue"        // 时间线的颜色
                        }
                    },
                    checkpointStyle: {       // 当前项的图形样式，时间轴上显示
                        symbol: "none",      //标记的图形样式
                        color: "#bbb",           // 颜色
                        borderColor: "#666",     // 边框颜色
                        show: false,             // 不显示
                        borderWidth: 1           // 边框宽度
                    },
                    controlStyle: {          // “控制按钮”的样式。控制按钮包括：播放按钮，前进按钮和后退按钮
 
                        showNextBtn: true,             // 不显示前进按钮
                        showPrevBtn: true,             // 不显示后退按钮
                        normal: {
                            color: '#888',
                            show: false,
                            borderColor: "#888"
                        },
                        emphasis: {                  // 高亮状态相关设置
                            color: "#aaa",
                            borderColor: "#aaa"
                        }
                    },
                    data: rankData.map(function(ele) {      // 获取列表中每个原色的data部分
                        return ele.data
                    })
                },
 
 
                title: [{                          //标题
                    left: 'center',
                    top: '3%',
                    textStyle: {
                        fontSize: 25,
                        color: 'rgba(121,121,121, 0.9)'
                    }
                }, {
                    left: 'center',
                    top: '5%'
                }],
                grid: [{                    //网格
                    left: '20%',
                    right: '20%',
                    top: '12%',
                    height: 'auto',
                    bottom: '15%'
                }],
                xAxis: {},
                yAxis: {},
                series: [{
                    id: 'bar',                  // 设置id属性
                    type: 'bar',                //柱状图
                    barWidth: '80',
                    tooltip: {
                        show: false
                    },
                    label: {                // 文本标签
                        normal: {
                            show: true,
                            position: 'right'       // 文本标签位于右侧
                        }
                    },
                    data: []
                }]
            },
            options: []
        };
 
 
        // 第四部分
        // 由于是动态的可视化，使用每次显示的内容除了以上固定不变的部分，还有变化的部分，主要是与数据相关的展示。
        // 以下代码主要完成以循环的方式将数据加入可视化模板代码中，用到了option的push方法以加入数据相关内容
 
        var xMaxInterval = 5;
 
        // 数据索引第一位是14日，想日期从10日开始加载，逆向遍历输出
        for (var i = rankData.length - 1; i >= 0; i--) {
            var xMax = 20;
            if (rankData[i].data[0].value > 20) {                               // 当此排行中第一个数据是否大于20
                xMax = 'dataMax'                                            //此时取数据在该轴上的最大值作为最大刻度
            }
            if (rankData[i].data[0].value / xMaxInterval >= 10) {
                xMaxInterval = rankData[i].data[0].value / 5                    //减小最大间隔
            }
 
            option.options.push({
                backgroundColor: new echarts.graphic.RadialGradient(0.3, 0.3, 0.8, [{           //背景的径向渐变
                    offset: 0,
                    color: '#f7f8fa'
                }, {
                    offset: 1,
                    color: '#cdd0d5'
                }]),
 
                title: {
                    text: title + ' ' + rankData[i].category,                   //构造标题
                    color: '#bfbfbf'
                },
                xAxis: [{   
                    name:'数值',                              //x轴相关设置
                    show: true,
                    type: 'value',
                    interval: xMaxInterval,                 //强制设置坐标轴分割间隔
                    max: xMax,
                    axisTick: {             // 坐标轴刻度样式
                        show: true                       //不显示坐标轴刻度
                    },
                    axisLabel: {                             //坐标轴刻度标签的相关设置
                        show: true,
                        color: 'rgba(121,121,121,0.9)',
                        textStyle: {
                            color: 'rgba(121,121,121,0.9)'
                        }
                    },
                    axisLine: {                             //坐标轴线相关设置
                        show: false,
                        lineStyle: {
                            color: 'rgba(121,121,121,0.3)'
                        }
                    },
                    splitLine: {                            //坐标轴在 grid 区域中的分隔线
                        show: true,
                        lineStyle: {
                            color: ['rgba(121,121,121,0.3)', 'rgba(121,121,121,0.3)']
                        }
                    }
                }],
                
                yAxis: [{
                    name:'姓名',
                    type: 'category',
                    axisTick: {
                        show: true

                    },
                    axisLine: {         // 分割线样式
                        show: true,
                        lineStyle: {
                            color: 'rgba(121,121,121,0.3)'
                        }
                    },
                    axisLabel: {        // 坐标轴标签样式
                        show: false,
                        textStyle: {}
                    },
                    data: rankData[i].data.map(function(ele) {             //拿到每个项目元素的名称
                        return ele.name
                    })
                }],
                series: [{
                    id: 'bar',                      //组件 ID。默认不指定。指定则可用于在 option 或者 API 中引用组件
                    itemStyle: {
                        normal: {
                            color: function (params) {                          //设置一个颜色数组，最好比序列内的数据点个数要大或者相等
                                                                              //根据当前数据点在当前序列内所处的顺序序号去颜色数组内自动匹配颜色
                                var colorListr = [
                                '#8B008B',
                                '#FF1493',
                                '#FFB6C1',
                                '#DC143C',
                                '#00008B',
                                '#1E90FF',
                                '#00FFFF'
                                ];
                                return colorListr[params.dataIndex]
                            },
                            label: {
                                show: true,
                                fontSize: 10,
                                position: 'top',
                                formatter: '{c}%'
                            },
                            shadowBlur: 10,
                            shadowColor: 'rgba(40, 40, 40, 0.5)',
                        }
                    },
                    label: {                           //条形图的标签
                        normal: {
                            position: 'right',                      //标签显示位置
                            formatter: function (p) {
                                return p.name + ": " + p.value;              //标签显示元素名称和具体值
                            }
                        }
                    },
                    data: rankData[i].data.map(function(ele) {
                        return ele.value
                    }).sort(function (a,b) {
                        return a- b
                    })
                }]
            })
        }
 
 
        myChart.setOption(option)
 
</script>
 
</body>
</html>
       